"use strict";function render(e){$.ajax({url:"../../interface/cartList.php",data:{uId:e},beforeSend:function(){NProgress.configure(),NProgress.start()},dataType:"json",success:function(e){if(0!=e.length){var t=template("cartInfo",{data:e});$(".list-body").html(t)}else $(".list-body").html('<div class="cart-info">购物车里面还没有东西呢，去购物吧</div>')},complete:function(){NProgress.done()}})}function del(t){$(".list-body").on("click",".del",function(){if(confirm("确认删除该商品吗？")){var e=$(this).attr("data-id");$.ajax({type:"get",url:"../../interface/cartDel.php",data:{id:e},beforeSend:function(){NProgress.configure(),NProgress.start()},dataType:"json",success:function(e){1==e.code&&render(t)}})}})}function update(n){$(".list-body").on("click",".sub",function(){var e=$(this).parent().attr("data-id"),t=$(this).siblings(".nums").html();1!=t?(t--,$(this).siblings(".nums").html(t),change(e,t,function(){render(n)})):alert("数量不能为0")}),$(".list-body").on("click",".add",function(){var e=$(this).parent().attr("data-id"),t=$(this).siblings(".nums").html();t++,$(this).siblings(".nums").html(t),change(e,t,function(){render(n)})})}function change(e,t,n){$.ajax({type:"get",url:"../../interface/cartUpdate.php",data:{id:e,num:t},beforeSend:function(){NProgress.configure(),NProgress.start()},dataType:"json",success:function(e){1==e.code&&n&&n()}})}$(function(){if(!getCookie("username"))return alert("请先登录"),void(location.href="../pages/login.html");$(".un").text(getCookie("username"));var e=getCookie("userId");render(e),del(e),update(e),$(".user").hover(function(){$(".username").css("color","#ff6700").css("background","#fff"),$(".userMenu").css("height",85)},function(){$(".username").css("color","#424242").css("background","none"),$(".userMenu").css("height",0)}),$("#J_userLogout").click(function(){removeCookie("username"),removeCookie("userId"),location.href="../pages/index.html"})});